
# Downstream Analysis

Two scripts for the downstream analysis :

`enrichment_analysis.py`

This script applies downstream analysis on the inferred gene regulatory network, utilizing GO enrichment analysis and KEGG pathway enrichment analysis.

Initially, it divids the network into two distinct networks based on the respective conditions: one for the exhausted condition and the other for the macrophages pretreatment condition. Subsequently, Go enrichment analysis and KEGG analysis are performed on each of these networks.

`scanet_analysis.py`

SCANet has nice visualization capabilities, which are utilized in this script.


## Requirements

`enrichment_analysis.py`

- Python 3.6+
- argparse
- gprofiler
- gseapy
- pandas
- os


`scanet_analysis.py`

- scanet
- pickle

## Input

`enrichment_analysis.py` :

- `Path to the network.tsv` file, which is a tab-separated file that contains all edges with the columns target, regulator, condition and weight.

- `output path` : String indicating the path where the output will be stored. The directory doesn't have to exist beforehand; it will be automatically created if it doesn't.

`scanet_analysis.py` :

The input for this script is a pickle file containing the inferred modules and data after representative cells creation. This pickle file is generated by executing the scanet_on_ref_data script. The repository contains the file generated by running the script on the full input dataset.

## Output

`enrichment_analysis.py` :

The following output files will be saved in the specified directory :

- **Go_enriched_terms.tsv:** The results of the GO enrichment analysis/
  
- **Top_go_enriched_terms.tsv:** Here, the top enriched GO terms for each condition, based on the ratio between the `intersection size` and `term size`.
  
- **KEGG_enriched_pathways.tsv** The results of the KEGG pathway enrichment analysis.
  
- **Top_KEGG_enriched_pathways.tsv:** The top enriched KEGG pathways, based on the `Combined Score`.

`scanet_analysis.py` :

Visualizations of the inferred modules.

## Usage

`enrichment_analysis.py` :

Provide an input network file in TSV format and an output directory for results:

```bash
python enrichment_analysis.py --c <input_network.tsv> --o <output_directory>
```

`scanet_analysis.py` :

```bash
python scanet_analysis.py --c <net.pkl>
```

### Arguments

`enrichment_analysis.py` :

- `--c`: Path to the input network file (TSV format).
- `--o`: Directory where output files will be saved.


`scanet_analysis.py` :

`--c`: Path to the pickle file

## Examples

```bash
python enrichment_analysis.py --c "../../network.tsv" --o "../../output"
```

```bash
python scanet_analysis.py --c "../../net.pkl"
```